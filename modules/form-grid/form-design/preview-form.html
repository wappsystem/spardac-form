<div id=D__ID>
	<!--third html start -->
	<div class="container mt-95">
	  <!-- form container start -->
	  	<div class="formbox">
		<!-- form start -->
			<form id="F__ID">
		  		<span id=title__ID></span>
				<div id="questionaire_form__ID"></div>
				<div class="formgroup textcenter">
					<button type="button" id="preview__ID" class="btn">Preview</button><span>&nbsp;</span>
					<button type="button" id="form__ID" class="btn">Download Form</button><span>&nbsp;</span>
					<button type="button" id="grid__ID" class="btn">Download Gridview</button>
				</div>
			</form>
		</div>
	</div>
	<script>
		function F__ID() {
			//-------------------------------------
			VmInclude: '__HOST__/assets/js/form.01.js'
			//-------------------------------------
			var html_content=""
			var entry_data=[];
			var load = m.load;
			var form_html = "";
			var script_other="    //-------------------------------------\n ";
			var script_load="    //-------------------------------------\n ";
			var style_content="";
			m.load = function () {
				load();
                var form_uid=(m.input.record.UID).toString();
                //m.query={$and: [{'Data.Participant_uid':{$exists: true}}, {'Data.Participant_uid': {'$ne' : ''}}]}
                m.query={"Data.Form_uid": {"$eq" : form_uid}};
                m.sort={'I1':-1}
                jQuery.ajaxSetup({async:false});
                $vm.request({api:m.api,cmd:'find',table:m.Table,query:m.query,sort:m.sort},function(res){
                    //console.log(res)
                    entry_data=res.result
				})
				//console.log(JSON.stringify(entry_data))
				if(entry_data!=undefined) create_form(entry_data);
                jQuery.ajaxSetup({async:true});
			}
			//-----------------------------
			$('#form__ID').on('click',function(){
				html_content="<div id=D@@ID>\n<div class=\"container mt-95\">\n<div class=\"formbox\">\n<form id=\"F@@ID\">\n<span id=title@@ID></span>\n<div id=\"participant_div@@ID\">\n<div class=\"formgroup\">\n<fieldset class=\"dynbreaks\">\n<label><span class=\"question\">Participant</span>\n<input type=text name=\"Participant\" class=formcontrol id=Participant@@ID data-id=\"Participant\" />\n</label><br>\n<label><span class=\"question\">Participant ID</span>\n<input type=text name=\"Participant_uid\" class=formcontrol readonly />\n</label>\n</fieldset>\n</div>\n</div>\n"
				html_content+=form_html;
				html_content+="<div class=\"formgroup right\">\n  <button type=\"submit\" id=\"submit__ID\" class=\"submit_btn\">Submit</button>\n</div>\n</form>\n</div>\n</div>\n"	
				html_content+="<script>\n  function F@@ID() {\n    //-------------------------------------\n    Vm##Include: '@@COMPONENT@@/f/form.01.js'\n    Vm##Include: '@@HOST@@/assets/js/shared-form.js'\n    //-------------------------------------\n    var load2 = m.load;\n    m.load = function () {\n      load2();\n      $('#title@@ID').text($vm.module_list[$vm.vm['@@ID'].name].task_name);\n"+script_load+"    }\n//-------------------------------------\n"+script_other+"  }\n  %%script>"
				html_content+="<style>\n/*Vm##Include:@@HOST@@/assets/css/wapp-form.css*/\n"+style_content+"%%style>\n</div>";
				html_content=html_content.replace(/@@/g,'__').replace(/##/g,'').replace(/%%/g,'</');
				var htmlContent = [html_content];
				var bl = new Blob(htmlContent, {type: "text/html"});
				var a = document.createElement("a");
				a.href = URL.createObjectURL(bl);
				a.download = m.input.record.Data.Name+"-form.html";
				a.hidden = true;
				document.body.appendChild(a);
				a.innerHTML = "";
				a.click();
			})
			//-----------------------------
			$('#preview__ID').on('click',function(){
				html_content="<div id=D@@ID>\n<div class=\"container mt-95\">\n<div class=\"formbox\">\n<form id=\"F@@ID\">\n<span id=title@@ID>"+m.input.record.Data.Name+"</span>\n"
				html_content+=form_html;
				html_content+="\n</form>\n</div>\n</div>\n"	
				html_content+="<script>\n  function F@@ID() {\n    //-------------------------------------\n    Vm##Include: '@@COMPONENT@@/f/form.01.js'\n    //-------------------------------------\n    var load2 = m.load;\n    m.load = function () {\n      load2();\n      $('#title@@ID').text($vm.module_list[$vm.vm['@@ID'].name].task_name);\n"+script_load+"    }\n//-------------------------------------\n"+script_other+"  }\n  %%script>"
				html_content+="<style>\n/*Vm##Include:@@HOST@@/assets/css/wapp-form.css*/\n"+style_content+"%%style>\n</div>";
				html_content=html_content.replace(/@@/g,'__').replace(/##/g,'').replace(/%%/g,'</');
				console.log(m.form_module)
				localStorage.setItem('http://127.0.0.1:8000/wappsystem/spardac-formhttp://127.0.0.1:8000/wappsystem/spardac-form/modules/form-grid/form-design/preview.html_txt',html_content)
				$vm.load_content('preview','','',html_content)
			});
			//-----------------------------
			create_form=function (entry_data){
				form_html = "";
				for (var i=0;i<entry_data.length;i++){
					var specified_width="";
					var input_style="";
					var min = "";
                    var max = "";
                    var step = "";
					switch (entry_data[i].Data.layout) {
						case 'Main Header':
							form_html += "<h3 style='margin-left:30px'>" + entry_data[i].Data.input_1 + "</h3>"
							break;
						case 'Instructions':
							form_html += '<div class="formgroup"><fieldset class=""><span class="question"><p>' + entry_data[i].Data.input_1 + '</p></span><span>' + entry_data[i].Data.input_2 + '</span></fieldset></div>';
							break;
						case 'Dual radio buttons':

							form_html += '<div class="formgroup"><span class="question"></span><fieldset class="grid-container-1"><div class=""><label><span class="question">' + entry_data[i].Data.input_1 + '</span></label><br><input id="' + entry_data[i].Data.input_3 + '_1__ID" name="' + entry_data[i].Data.input_3 + '" type="radio" value="' + entry_data[i].Data.input_4 + '" '+entry_data[i].Data.req+' ><label class="rd_btn" for="' + entry_data[i].Data.input_3 + '_1__ID">' + entry_data[i].Data.input_5 + '</label><input id="' + entry_data[i].Data.input_3 + '_2__ID" name="' + entry_data[i].Data.input_3 + '" type="radio" value="' + entry_data[i].Data.input_6 + '"><label class="rd_btn" for="' + entry_data[i].Data.input_3 + '_2__ID">' + entry_data[i].Data.input_7 + '</label>';
							if(entry_data[i].Data.specify_1!=""){
								form_html +='<div id="' + entry_data[i].Data.input_3 + '_option__ID" class="formgroup hide"><label><span class="question">' + entry_data[i].Data.specify_1 + '</span></label><br><input  name="' + entry_data[i].Data.specify_2 + '" type="text" class="formcontrol fullwidth"></div>';
								script_load+="if($('#F@@ID input[name=\"" + entry_data[i].Data.input_3 + "\"]:checked').val()=='"+entry_data[i].Data.specify_3+"'){\n        $('#F@@ID #"+entry_data[i].Data.input_3+"_option@@ID').show();\n      }\n      else {\n        $('#F@@ID #"+entry_data[i].Data.input_3+"_option@@ID').hide();\n      } "
								script_other+=" $('#F@@ID input[name=\"" + entry_data[i].Data.input_3 + "\"]').on('change',function(){ if($('#F@@ID input[name="+entry_data[i].Data.input_3+"]:checked').val()=='"+entry_data[i].Data.specify_3+"'){\n        $('#F@@ID #"+entry_data[i].Data.input_3+"_option@@ID').show();\n      }\n      else {\n        $('#F@@ID #"+entry_data[i].Data.input_3+"_option@@ID').hide();\n      }\n});\n"
							}
							form_html += '</div></fieldset></div>';
							break;
						case 'Single text input':
							if (entry_data[i].Data.input_9 == '1') specified_width = " fullwidth";
							if (entry_data[i].Data.input_10 == '0') input_style = "text";
                        	else if (entry_data[i].Data.input_10 == '1') {
								input_style = "number";
	                            min = "min=" + entry_data[i].Data.input_6
    	                        max = "max=" + entry_data[i].Data.input_7
        	                    step = "step=" + entry_data[i].Data.input_8
                        	}
                       		else if (entry_data[i].Data.input_10 == '2') input_style = "date";
                        	else if (entry_data[i].Data.input_10 == '3') input_style = "time";

							form_html += '<div class="formgroup"><fieldset class=""><span class="question">' + entry_data[i].Data.input_1 + '</span><div class="grid-container-1"><div><label><span class="question">' + entry_data[i].Data.input_5 + '</span><input id="abcd" type=' + entry_data[i].Data.input_style + ' name="' + entry_data[i].Data.input_3 + '" class="formcontrol ' + entry_data[i].Data.specified_width + '" ' + entry_data[i].Data.min + ' ' + entry_data[i].Data.max + ' ' + entry_data[i].Data.step + ' placeholder="' + entry_data[i].Data.input_4 + '" '+entry_data[i].Data.req+' /></label></div></div></fieldset></div>';
							break;
						case 'Visual Analogue Scale':
							form_html += '<div class="formgroup">\n<fieldset class="">\n<div class="textcenter">\n<span class="question">' + entry_data[i].Data.input_1 + '</span>\n</div>\n<div class="grid-container-slider">\n<div class="textleft">\n<span class="question">' + entry_data[i].Data.input_4 + '</span>\n<input type="text" id="vas_req@@ID" '+entry_data[i].Data.req+' style="opacity:0">\n</div>\n<div class="slidecontainer" id=vas_con@@ID>\n<input type="range" min="0" max="' + entry_data[i].Data.range + '" step=' + entry_data[i].Data.vas_step + ' class="slider" name="' + entry_data[i].Data.input_3 + '" id="vas@@ID">\n</div>\n<div class="textright">\n<span class="question">' + entry_data[i].Data.input_5 + '</span>\n</div>\n</div>\n</fieldset>\n</div>';
							script_load+="\n//-------------------------------------\nif (m.input.record != undefined) \n{$('<style>#vas_con@@ID input[type=\"range\"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 5px; height: 25px; background: #167d7f; cursor: pointer; }</style>').appendTo('head');$('#vas_req@@ID').val(\"OK\")} \nelse { $('<style>#vas_con@@ID input[type=\"range\"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 0px; height: 0px; background: #167d7f; cursor: pointer; }</style>').appendTo('head');}"
							script_other+="\n//-------------------------------------\n $('#vas@@ID').on('click', function () {$('<style>#vas_con@@ID input[type=\"range\"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 5px; height: 25px; background: #167d7f; cursor: pointer; }</style>').appendTo('head');$('#vas_req@@ID').val(\"OK\")})//-------------------------------------\n";
							break;
/*						case 'Digital Scale':
							form_html = '<div class="formgroup"><div class="questiongroup "><fieldset class="dynbreaks"><div class="textcenter"><span class="question">' + input_1 + '</span></div><div class="grid-container-3-special"><div class="textleft"><span class="question">' + input_4 + '</span></div><div class="textcenter">';
							if (start != undefined && end != undefined) {
								for (var i = start; i < end + 1; i = i + step) {
									form_html += '<input id="' + input_3 + '_' + i.toString() + '__ID" name="' + input_3 + '" type="radio" value="' + i.toString();
									if(i==start) form_html +='" '+req+' >';
									else form_html +='" >';
									form_html += '<label class="rd_btn" for="' + input_3 + '_' + i + '__ID">' + i.toString() + '</label><br>'
								}
							}
							form_html += '</div><div class="textright"><span class="question">' + input_5 + '</span></div></div></fieldset></div></div>';
							break;
						case 'Multiple horizontal number inputs':
							$('#multiple_horizontal_number_inputs__ID').show()
							var max = "";
							var min = "";
							var width = ""
							if ($('#F__ID input[name=input_9]:checked').val() == '1') input_9 = " fullwidth";
							else input_9 = "";
							if (entry_data[i].Data.input_10 == '0') input_10 = "2";
							else if (entry_data[i].Data.input_10 == '1') input_10 = "3"
							else if (entry_data[i].Data.input_10 == '2') { input_10 = "4"; width = "width_input_4"; }
							else if (entry_data[i].Data.input_10 == '3') { input_10 = "5"; width = "width_input_5"; }
							else if (entry_data[i].Data.input_10 == '4') { input_10 = "6"; width = "width_input_6"; }
							var box_num = parseInt(input_10)
							if (box_num != undefined) {
								form_html = '<div class="formgroup"><fieldset class=""><span class="question">' + input_1 + '</span><div class="grid-container-input-' + input_10 + '">';
								for (var i = 0; i < box_num; i++) {
									form_html += '<div><label><span id=input_label_' + i + '__ID class="question"></span><input type=number id="input_id_' + (i) + '__ID" class="formcontrol ' + width + '" '+req+' /></label></div>';
								}
								form_html += '</div></fieldset></div>';
							}
							$('#questionaire_form__ID').html(form_html)
							m.item_a_fields = "Database name|input_3_a,Label text|input_5_a,Text inside input box|input_4_a,Min value|input_6_a,Max value|input_7_a,Step value|input_8_a,_Remove";
							m.item_a_after_change();
							break;
						case 'Multiple horizontal inputs':
							var width = ""
							if (entry_data[i].Data.input_10 == '0') input_10 = "2";
							else if (entry_data[i].Data.input_10 == '1') input_10 = "3"
							else if (entry_data[i].Data.input_10 == '2') { input_10 = "4"; width = "width_input_4"; }
							else if (entry_data[i].Data.input_10 == '3') { input_10 = "5"; width = "width_input_5"; }
							else if (entry_data[i].Data.input_10 == '4') { input_10 = "6"; width = "width_input_6"; }
							var box_num = parseInt(input_10)
							if (box_num != undefined) {
								form_html = '<div class="formgroup"><fieldset class=""><span class="question">' + input_1 + '</span><div class="grid-container-input-' + input_10 + '">';
								for (var i = 0; i < box_num; i++) {
									form_html += '<div><label><span id=input_label_' + i + '__ID class="question"></span><input id="input_id_' + (i) + '__ID" class="formcontrol ' + width + '" '+req+' /></label></div>';
								}
								form_html += '</div></fieldset></div>';
							}
							m.item_a_fields = "Database name|input_3_a,Label text|input_5_a,Text inside input box|input_4_a,Type of entry|input_10_a,_Remove";
							m.item_a_after_change();
							break;
						case 'Horizontal radio buttons':
							var width = ""
							if (entry_data[i].Data.input_10 == '0') {input_10 = "3"; width = "width_input_3";}
							else if (entry_data[i].Data.input_10 == '1') {input_10 = "4"; width = "width_input_4";}
							else if (entry_data[i].Data.input_10 == '2') { input_10 = "5"; width = "width_input_5"; }
							else if (entry_data[i].Data.input_10 == '3') { input_10 = "6"; width = "width_input_6"; }
							else if (entry_data[i].Data.input_10 == '4') { input_10 = "7"; width = "width_input_7"; }
							var box_num = parseInt(input_10)
							if (box_num != undefined) {
								form_html = '<div class="formgroup"><div class="questiongroup "><fieldset class=""><span class="question">' + input_1 + '</span><div class="grid-container-' + input_10 + '">';
								for (var i = 0; i < box_num; i++) {
									form_html += '<div ><input id="'+input_3+'_'+i+'__ID" name="'+input_3+'" type="radio"';
									if(i==0) form_html +=' '+req+' >';
									else form_html +=' >'
									form_html +='<label id="button_text_'+i+'__ID" class="rd_btn '+width+'" for="'+input_3+'_'+i+'__ID"></label></div>';
								}
								form_html += '</div></fieldset></div></div>';
							}
							m.item_a_fields = "Button text|input_5_a,Button value|input_4_a,_Remove";
							m.item_a_after_change();
							break;
						case 'Vertical radio buttons':
							var width = ""
							if (entry_data[i].Data.input_10 == '') {width = "";}
							else if (entry_data[i].Data.input_10 == '1') {width = "width_btn_130";}
							else if (entry_data[i].Data.input_10 == '2') {width = "width_btn_250";}
							else if (entry_data[i].Data.input_10 == '3') {width = "width_btn_full"; }
								form_html = '<div class="formgroup"><div class="questiongroup"><fieldset class=""><span class="question"><p>'+input_1+'</p></span>';
								for (var i = 0; i < m.item_a_records.length; i++) {
									form_html += '<input id="'+input_3+'_'+i+'__ID" name="'+input_3+'" type="radio"';
									if(i==0) form_html +=' '+req+' >';
									else form_html +=' >'
									form_html +='<label id="button_text_'+i+'__ID" class="rd_btn '+width+'" for="'+input_3+'_'+i+'__ID"></label><br>';
								}
								form_html +='<div id="' + input_3 + '_option__ID" class="formgroup hide"><label><span class="question">' + specify_1 + '</span></label><br><input  name="' + specify_2 + '" type="text" class="formcontrol fullwidth"></div>';
								form_html += '</fieldset></div></div>';
							m.item_a_fields = "Button text|input_5_a,Button value|input_4_a,_Remove";
							m.item_a_after_change();
							break;
							case 'Vertical Checkboxes':
							var width = ""
							if (entry_data[i].Data.input_10 == '') {width = "";}
							else if (entry_data[i].Data.input_10 == '1') {width = "width_btn_130";}
							else if (entry_data[i].Data.input_10 == '2') {width = "width_btn_250";}
							else if (entry_data[i].Data.input_10 == '3') {width = "width_btn_full"; }
							form_html = '<div class="formgroup"><div class="questiongroup"><fieldset class=""><span class="question"><p>'+input_1+'</p></span>';
							for (var i = 0; i < m.item_a_records.length; i++) {
								form_html += '<input id="input_id_' + i + '__ID" type="checkbox" >';
								form_html +='<label id="button_text_'+i+'__ID" class="rd_btn '+width+'" for="input_id_' + i + '__ID"></label><br>';
							}
							form_html +='<div id="' + input_3 + '_option__ID" class="formgroup hide"><label><span class="question">' + specify_1 + '</span></label><br><input  name="' + specify_2 + '" type="text" class="formcontrol fullwidth"></div>';
							form_html += '</fieldset></div></div>';
							m.item_a_fields = "Checkbox text|input_5_a,Checkbox value|input_4_a,Database Name|input_3_a,_Remove";
							m.item_a_after_change();
							break;
							case 'Dropdown List':
							form_html = '<div class="formgroup"><div class="questiongroup"><fieldset class=""><span class="question"><p>'+input_1+'</p></span><select id="' + input_3 + '__ID" name="' + input_3 + '" '+req+' class="formcontrol" >';
							for (var i = 0; i < m.item_a_records.length; i++) {
								form_html += '<option ></option>';
							}
							form_html += '</select></fieldset></div></div>';
							m.item_a_fields = "Dropdown option text|input_5_a,Option value|input_4_a,_Remove";
							m.item_a_after_change();
							break;*/
							case 'Textarea':
							var specified_width="";
							if (entry_data[i].Data.input_9 == '1') specified_width = " fullwidth";
							form_html += '<div class="formgroup"><div class="questiongroup"><fieldset class=""><span class="question"><p>'+entry_data[i].Data.input_1+'</p></span><label><span class="question">' + entry_data[i].Data.input_5 + '</span><textarea class="formcontrol '+ specified_width +'" name="'+entry_data[i].Data.input_3+'" placeholder="'+entry_data[i].Data.input_4+'" '+entry_data[i].Data.req+' ></textarea></label></fieldset></div></div>';
							break;
						/*default:
							console.log("DEFAULT")
							$('#questionaire_form__ID').html("<div></div>")
							$('#question__ID').text("");
							break;*/
						}

                }
				//form_html=form_html.replace(/@@/g,'__').replace(/##/g,'').replace(/%%/g,'</');
				//$('#questionaire_form__ID').html(form_html)
			}
			//-------------------------------------
			m.before_submit = function (data, index) {
			}
			//-------------------------------------
		}
	</script>
	<style>
		#D__ID {
		}

		/*VmInclude:__HOST__/assets/css/wapp-form.css*/
	</style>
</div>